
# ===========================================
# ADXL345 Accelerometer & Input Shaping Setup
# ===========================================

[mcu adxl]
# Change <mySerial> to whatever you found above. For example,
# usb-Klipper_rp2040_E661640843545B2E-if00
serial: /dev/serial/by-id/usb-Klipper_rp2040_E6626005A70A7933-if00

# ----------------------------
# Accelerometer Configuration
# ----------------------------

[adxl345]
cs_pin: adxl:gpio9
spi_software_sclk_pin: adxl:gpio10
spi_software_mosi_pin: adxl:gpio11
spi_software_miso_pin: adxl:gpio12
axes_map: x,z,y

# ----------------------------
# Resonance Tester
# ----------------------------

[resonance_tester]
accel_chip: adxl345
probe_points:
    # Somewhere slightly above the middle of your print bed
    119,119,10
    
# ----------------------------
# Input Shaper Settings (Adjust after SHAPER_CALIBRATE)
# ----------------------------
[input_shaper]
shaper_type_x: mzv
shaper_freq_x: 42.0
shaper_type_y: mzv
shaper_freq_y: 41.5
damping_ratio_x: 0.15
damping_ratio_y: 0.15

# =============================
# Optional Macros for Ease of Use
# =============================

[gcode_macro CALIBRATE_SHAPER]
description: "Run shaper calibration"
gcode:
    RESPOND PREFIX="INFO" MSG="Menjalankan shaper_calibrate"
    SHAPER_CALIBRATE

[gcode_macro TEST_RESONANCE]
description: "Run resonance test for X and Y"
gcode:
    RESPOND PREFIX="INFO" MSG="Menjalankan get_resonances"
    MEASURE_AXES_NOISE
    TEST_RESONANCES AXIS=X
    TEST_RESONANCES AXIS=Y

[gcode_macro MEASURE_NOISE]
description: "Measure noise levels on axes"
gcode:
    MEASURE_AXES_NOISE

   
